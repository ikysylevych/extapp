{"name":"Extapp","tagline":"Extapp is the tool to build ExtJS applications. Ranking dependencies and combining all ExtJS classes into one output file.","body":"# About\r\n\r\n\r\nExtapp is the lightweight tool to build ExtJS applications. The main goal is to collect all dependencies required by JS application into one production-ready output file.\r\n\r\nThe tool is processing build in *non-conflict manner*. It may alert developer about errors and warnings but mainly it does not break the build because for example of duplicates or some class file was not found etc.\r\n\r\nNo additional comment conventions needed. Extapp avoids some custom magic comments like /\\*requires file.js \\*/. It uses native ExtJS dependencies declarations in **Ext.define()** method or in any other place in the code.\r\n\r\n**The main features of the Extapp tool:**\r\n- resolving dependencies\r\n- deduplicate referenced dependencies\r\n- ranking classes based on references\r\n- smart avoid of infinite loops\r\n- build sources into one output file\r\n- usage in other JS frameworks\r\n\r\n\r\n# Usage\r\n\r\n```bash\r\nUsage: java -jar extapp-yyyy.mm.jar [options] [base path] [config file] [source file] [output file]\r\n\r\nGlobal Options\r\n  -h, --help                    Displays this information\r\n  -v, --verbose                 Display informational messages and warnings\r\n  -l, --delimiter               Output a delimiter between combined files\r\n  -b, --basePath                Base path to web folder (absolute or relative)\r\n  -c <file>, --config <file>    Config file with extapp options\r\n  -s <file>, --source <file>    Source file. Starting point to process dependencies.\r\n  -o <file>, --output <file>    Place the output into <file>. Defaults to source file\r\n```  \r\n\r\n# Main features\r\n\r\n## Reading dependencies\r\n\r\nEach Ext class usually starts with **'Ext.define()'** method. Parameters like **'requires', 'uses', 'controllers', 'views'** etc refer to other classes which have to be declared before current ext class.\r\n\r\nThere are three reference types which can be grouped like this:\r\n- **array types without folders**: 'requires', 'uses'\r\n- **array types with folders**: 'controllers', 'models', 'stores', 'views'\r\n- **string types**: 'extend', 'model', 'store'\r\n\r\n## Rankink classes\r\n\r\nThe simpliest way to prioritize classes is to rank them based on references. \r\n\r\n**For example:** if **class 'A'** with rank #1 requires **class 'B'** with *rank 1* - then **class 'B'** rises to *rank 2*. After that if **class 'C'** with *rank 4* uses **class 'A'** - then **class 'A'** raises to *rank 5* and **class 'B'** raises to *rank 6*.\r\n\r\nThe ranking table guarantees that all classes are correctly prioritized and will be defined with referencing to already declared classes. \r\n\r\n## Smart avoid of infinite loops\r\n\r\nI have did not find the 100% orthodox way to find out if classes dependencies chains will go into infinite loops.\r\n\r\nIt was resolved with easy trick - *rank limit* introduced. Usually the very huge ExtJS application reaches up to 10-15 rank levels. So we can assume that if rank goes for example to 100 it is very unusual and possibly it is the infinite loop.\r\n\r\n## Build sources into one output file\r\n\r\nActually this is the core feature of the tool. On production environments we don't need to load hundreds of small files with ExtJS classes declared. It significantly decreases browser performance and UI experience. We want to have one combined script file even with ~10Mb size. User can wait one time.\r\n\r\n## Extapp VS Sencha.cmd\r\n\r\nSencha.cmd is the ultimate tool to work with ExtJS applications.\r\n\r\nExtapp is about something different.\r\n- excluding native **'Ext'** sources\r\n- working in non-conflict way\r\n- deployment friendly\r\n\r\n### Excluding native **'Ext'** sources\r\n\r\nThe big ExtJS appications usually use many of core ExtJS sources. That is why it is useful just to include 'ext-all.js' and do not care about native **'Ext'** classes. Extapp does the job. You may exclude **'Ext'** class but include **'Ext.data'** etc.\r\n\r\n### Working in non-conflict way\r\n\r\nWe do not want the dictatorship of the tools. Class was not found ? - OK. Go ahead. Duplicates? - Nevermind. Output file was not set? - Let's backup the source file and use it instead!\r\n\r\n### Deployment friendly\r\n\r\nIt is much more easy to integrate one simple jar file into deployment environments than install and manage huge tools.\r\n\r\nUse app build and sources at the same time. Ignoring set output file will backup source file and use it for app build. It is very useful to use the app build and sources at the same time on website. This way may help to not fail the production builds and the website will still working with references to source files.\r\n\r\nExtapp may be easily integrated in both ant and gradle deployment scripts.\r\n\r\n# Extapp examples\r\n\r\n## Demo Portal\r\n\r\n### Run in command line\r\n```bash\r\njava -jar .build/extapp-2014.06.jar -v -l -b app -c /portal/extapp-config.js -s /portal/app.js -o /portal/app-output.js\r\n```\r\n\r\n### Extapp config file\r\n```js\r\n{\r\n    name : 'Demo',\r\n    appFolder : '/portal',\r\n    \r\n    /**\r\n     * Paths to ext classes folders and specific files\r\n     *\r\n     */\r\n    paths : {\r\n        'Demo' : '/portal',\r\n        'DemoSingleton' : '/portal/DemoSingleton.js',\r\n        'Portal' : '/portal', // alternative for 'Demo' class. Points to the same folder\r\n        \r\n        'Ext' : '/ext/src', // path to ExtJS sources\r\n        'Ext.ux.form.field.BoxSelect' : '/portal/plugin/BoxSelect.js' // custom ExtJS class\r\n    },\r\n    \r\n    /**\r\n     * Read dependency types\r\n     *\r\n     */\r\n    dependTypes : {\r\n        // array types without folders\r\n        requires : true,\r\n        uses : true,\r\n        includes : true, // custom type (not documented in ExtJS)\r\n\r\n        // array types with folders\r\n        controllers : true,\r\n        models : true,\r\n        stores : true,\r\n        views : true,\r\n\r\n        // string types\r\n        extend : true,\r\n        store : true,\r\n        model : true\r\n    },\r\n    \r\n    /**\r\n     * Include/exclude Ext classes\r\n     *\r\n     */\r\n    extClasses : {\r\n        'Ext' : false, // default : exclude Ext classes\r\n        'Ext.util' : true\r\n    },\r\n    \r\n    /**\r\n     * Safe rank : prevents infinite loop on dependencies chain\r\n     *\r\n     */\r\n    safeRank : true,\r\n    safeRankLimit : 100\r\n}\r\n```\r\n\r\n### Command line output\r\n```bash\r\n$ java -jar .build/extapp-2014.06.jar -v -l -b app -c /portal/extapp-config.js -s /portal/app.js -o /portal/app-output.js\r\n\r\n[INFO] Base path : app\r\n[INFO] Config file : app/portal/extapp-config.js\r\n[INFO] Source file : app/portal/app.js\r\n[INFO] Output file : app/portal/app-output.js\r\n\r\n[INFO] Processing source files...\r\n\r\n[WARNING] Ext class 'Demo.modules.test.controller.Main' has 1 duplicate dependencies. File : /portal/modules/test/controller/Main.js\r\n\r\n[WARNING] Rank limit 100 has been reached. Possibly infinite loop took place.\r\nStop processing 'Demo.modules.test.view.TestView'. Please check dependency chain or disable safe rank.\r\nExt class 'Demo.modules.test.view.TestView'. File : /portal/modules/test/view/TestView.js\r\n\r\n[ERROR] File not found : /portal/store/SampleStore.js\r\n\r\n\r\n[INFO] Building ext app...\r\n\r\n[INFO] -- rank : extClass --\r\n[INFO] 100 : /portal/modules/test/view/TestView.js\r\n[INFO] 99 : /portal/modules/test/model/TestModel.js\r\n[INFO] 98 : /portal/modules/test/store/TestStore.js\r\n[INFO] 6 : /ext/src/util/CSS.js\r\n[INFO] 5 : /portal/DemoSingleton.js\r\n[INFO] 5 : /portal/model/AboutModel.js\r\n[INFO] 4 : /portal/store/AboutStore.js\r\n[INFO] 4 : /portal/view/app/Portlet.js\r\n[INFO] 4 : /portal/view/components/Window.js\r\n[INFO] 4 : /portal/view/components/Logo.js\r\n[INFO] 3 : /portal/view/portal/NavigationHeader.js\r\n[INFO] 3 : /portal/view/components/AboutWindow.js\r\n[INFO] 3 : /portal/view/portal/PortletsPanel.js\r\n[INFO] 2 : /portal/plugin/DemoPlugin.js\r\n[INFO] 2 : /portal/controller/Main.js\r\n[INFO] 1 : /portal/view/MainView.js\r\n[INFO] 1 : /portal/controller/Secondary.js\r\n[INFO] 1 : /portal/modules/test/controller/Main.js\r\n[INFO] 0 : /portal/app.js\r\n\r\n[INFO] Extapp build complete!\r\n\r\n[INFO] -- errors : 1\r\n[INFO] -- warnings : 2\r\n[INFO] -- total : 19 files\r\n[INFO] -- time : 0.409 seconds\r\n```\r\n\r\n## Calendar (ExtJS 5 Samples)\r\n\r\n### Run in command line\r\n```bash\r\njava -jar .build/extapp-2014.06.jar -v -l -b app -c /calendar/extapp-config.js -s /calendar/src/App.js\r\n```\r\n\r\n### Extapp config file\r\n```js\r\n{\r\n    name : 'Calendar',\r\n    appFolder : '/calendar',\r\n    \r\n    /**\r\n     * Paths to ext classes folders and specific files\r\n     *\r\n     */\r\n    paths : {\r\n        'Ext.calendar' : '/calendar/src',\r\n        'Ext' : '/ext/src' // path to ExtJS sources\r\n    },\r\n    \r\n    /**\r\n     * Read dependency types\r\n     *\r\n     */\r\n    dependTypes : {\r\n        // array types without folders\r\n        requires : true,\r\n        uses : true,\r\n        includes : false, // custom type (not documented in ExtJS)\r\n\r\n        // array types with folders\r\n        controllers : true,\r\n        models : true,\r\n        stores : true,\r\n        views : true,\r\n\r\n        // string types\r\n        extend : true,\r\n        store : true,\r\n        model : true\r\n    },\r\n    \r\n    /**\r\n     * Include/exclude Ext classes\r\n     *\r\n     */\r\n    extClasses : {\r\n        'Ext' : false, // default : exclude Ext classes\r\n        'Ext.calendar' : true\r\n    },\r\n    \r\n    /**\r\n     * Safe rank : prevents infinite loop on dependencies chain\r\n     *\r\n     */\r\n    safeRank : true,\r\n    safeRankLimit : 100\r\n}\r\n```\r\n\r\n### Command line output\r\n```bash\r\n$ java -jar .build/extapp-2014.06.jar -v -l -b app -c /calendar/extapp-config.js -s /calendar/src/App.js\r\n\r\n[INFO] Base path : app\r\n[INFO] Config file : app/calendar/extapp-config.js\r\n[INFO] Source file : app/calendar/src/App.js\r\n[INFO] No output file specified. Using source file for output instead.\r\n[INFO] Source backup file : app/calendar/src/App.src.js\r\n[INFO] Output file : app/calendar/src/App.js\r\n\r\n[INFO] Processing source files...\r\n\r\n[WARNING] Ext class 'Ext.calendar.data.MemoryCalendarStore' has 1 duplicate dependencies. File : /calendar/src/data/MemoryCalendarStore.js\r\n\r\n[WARNING] Ext class 'Ext.calendar.data.MemoryEventStore' has 1 duplicate dependencies. File : /calendar/src/data/MemoryEventStore.js\r\n\r\n\r\n[INFO] Building ext app...\r\n\r\n[INFO] -- rank : extClass --\r\n[INFO] 8 : /calendar/src/util/Date.js\r\n[INFO] 8 : /calendar/src/data/EventMappings.js\r\n[INFO] 7 : /calendar/src/dd/StatusProxy.js\r\n[INFO] 7 : /calendar/src/template/BoxLayout.js\r\n[INFO] 7 : /calendar/src/view/AbstractCalendar.js\r\n[INFO] 6 : /calendar/src/dd/DragZone.js\r\n[INFO] 6 : /calendar/src/dd/DropZone.js\r\n[INFO] 6 : /calendar/src/util/WeekEventRenderer.js\r\n[INFO] 6 : /calendar/src/template/Month.js\r\n[INFO] 6 : /calendar/src/view/MonthDayDetail.js\r\n[INFO] 5 : /calendar/src/view/Month.js\r\n[INFO] 5 : /calendar/src/template/DayHeader.js\r\n[INFO] 5 : /calendar/src/dd/DayDragZone.js\r\n[INFO] 5 : /calendar/src/dd/DayDropZone.js\r\n[INFO] 5 : /calendar/src/template/DayBody.js\r\n[INFO] 4 : /calendar/src/view/DayBody.js\r\n[INFO] 4 : /calendar/src/data/CalendarMappings.js\r\n[INFO] 4 : /calendar/src/view/DayHeader.js\r\n[INFO] 3 : /calendar/src/form/field/ReminderCombo.js\r\n[INFO] 3 : /calendar/src/form/field/CalendarCombo.js\r\n[INFO] 3 : /calendar/src/view/Day.js\r\n[INFO] 3 : /calendar/src/form/field/DateRange.js\r\n[INFO] 2 : /calendar/src/form/EventDetails.js\r\n[INFO] 2 : /calendar/src/data/CalendarModel.js\r\n[INFO] 2 : /calendar/src/view/Week.js\r\n[INFO] 2 : /calendar/src/data/EventModel.js\r\n[INFO] 1 : /calendar/src/data/Events.js\r\n[INFO] 1 : /calendar/src/form/EventWindow.js\r\n[INFO] 1 : /calendar/src/data/MemoryEventStore.js\r\n[INFO] 1 : /calendar/src/data/MemoryCalendarStore.js\r\n[INFO] 1 : /calendar/src/data/Calendars.js\r\n[INFO] 1 : /calendar/src/CalendarPanel.js\r\n[INFO] 0 : /calendar/src/App.js\r\n\r\n[INFO] Extapp build complete!\r\n\r\n[INFO] -- warnings : 2\r\n[INFO] -- total : 33 files\r\n[INFO] -- time : 0.836 seconds\r\n\r\n```\r\n\r\n# Deployment with ant/gradle examples\r\n\r\n## Ant targets\r\n```xml\r\n<project name=\"Extapp\" default=\"optimizeExtApps\" basedir=\".\">\r\n\r\n  <!-- define props -->\r\n  <taskdef resource=\"net/sf/antcontrib/antcontrib.properties\" />\r\n\r\n  <property name=\"extappJar\" value=\".build/extapp-2014.06.jar\" />\r\n  <property name=\"projectBasePath\" value=\"app\" />\r\n\r\n  <!-- Extapp Builder -->\r\n  <target name=\"extappBuilder\">\r\n    <echo message=\"Extapp optimizer : ${extappName}\" />\r\n    <java jar=\"${extappJar}\" fork=\"true\" failonerror=\"yes\">\r\n      <arg value=\"-v\" />\r\n      <arg value=\"-l\" />\r\n      <arg value=\"-b\" />\r\n      <arg value=\"${basePath}\" />\r\n      <arg value=\"-c\" />\r\n      <arg value=\"${configFile}\" />\r\n      <arg value=\"-s\" />\r\n      <arg value=\"${sourceFile}\" />\r\n      <arg value=\"-o\" />\r\n      <arg value=\"${outputFile}\" />\r\n    </java>\r\n  </target>\r\n  \r\n  <!-- Build portal with extapp -->\r\n  <target name=\"optimizePortal\">\r\n    <antcall target=\"extappBuilder\">\r\n      <param name=\"extappName\" value=\"portal\" />\r\n      <param name=\"basePath\" value=\"${projectBasePath}\" />\r\n      <param name=\"configFile\" value=\"/portal/extapp-config.js\" />\r\n      <param name=\"sourceFile\" value=\"/portal/app.js\" />\r\n      <param name=\"outputFile\" value=\"/portal/app-output.js\" />\r\n    </antcall>\r\n  </target>\r\n\r\n  <!-- Build calendar with extapp -->\r\n  <target name=\"optimizeCalendar\">\r\n    <antcall target=\"extappBuilder\">\r\n      <param name=\"extappName\" value=\"calendar\" />\r\n      <param name=\"basePath\" value=\"${projectBasePath}\" />\r\n      <param name=\"configFile\" value=\"/calendar/extapp-config.js\" />\r\n      <param name=\"sourceFile\" value=\"/calendar/src/App.js\" />\r\n      <param name=\"outputFile\" value=\"\" />\r\n    </antcall>\r\n  </target>\r\n\r\n  <!-- Optimize ExtJS apps with extapp builder -->\r\n  <target name=\"optimizeExtApps\">\r\n    <antcall target=\"optimizePortal\" />\r\n    <antcall target=\"optimizeCalendar\" />\r\n  </target>\r\n</project>\r\n```\r\n\r\n\r\n## Gradle tasks\r\n```groovy\r\ndef extappJar = '.build/extapp-2014.06.jar'\r\n\r\n/**\r\n * Extapp Builder\r\n *\r\n */\r\ndef extappBuilder(name, config, source) {\r\n    printSection('Extapp optimizer : ' + name)\r\n    javaexec {\r\n        main ='-jar'\r\n        args = [\r\n            file(extappJar).path, '-v', '-l', '-b', webDir, '-c', config, '-s', source\r\n        ]\r\n    }\r\n}\r\n\r\n/**\r\n * Optimize ExtJS apps with extapp builder\r\n *\r\n */\r\ntask optimizeExtApps << {\r\n    extappBuilder('portal', '/portal/extapp-config.js', '/portal/app.js')\r\n    extappBuilder('calendar', '/calendar/extapp-config.js', '/calendar/src/App.js')\r\n}\r\n\r\ndefaultTasks 'optimizeExtApps'\r\n```\r\n\r\n# Usage in other JS frameworks\r\n\r\nExtapp can be potentially used in other JS frameworks (not only ExtJS) which are developed similarly to ExtJS methodology.\r\n\r\n### ExtJS example\r\n```js\r\n// ExtJS methodology\r\nExt.define({'Ext.classOne.SubClass', {\r\n    extend: 'Ext.classOne.Class',\r\n    \r\n    requires: [\r\n        'Ext.classTwo.Class'\r\n    ],\r\n    \r\n    uses: [\r\n        'Ext.classTwo.SubClass'\r\n    ],\r\n    \r\n    init: function(){\r\n        // init\r\n    }\r\n});\r\n\r\nExt.define({'Ext.classTwo.SubClass', {\r\n    extend: 'Ext.classTwo.Class',\r\n    \r\n    init: function(){\r\n        // init\r\n    }\r\n});\r\n```\r\n\r\n### Rank results\r\n```bash\r\n[INFO] -- rank : extClass --\r\n[INFO] 2 : Ext/classTwo/Class.js\r\n[INFO] 1 : Ext/classOne/Class.js\r\n[INFO] 1 : Ext/classTwo/SubClass.js\r\n[INFO] 0 : Ext/classOne/SubClass.js\r\n```\r\n\r\n### Any other JS framework example\r\n```js\r\n// ExtJS methodology\r\nFramework.defineFunction('Framework.classOne.SubClass', {\r\n    extend: 'Framework.classOne.Class',\r\n    \r\n    requires: [\r\n        'Framework.classTwo.Class'\r\n    ],\r\n    \r\n    uses: [\r\n        'Framework.classTwo.SubClass'\r\n    ],\r\n    \r\n    init: function(){\r\n        // init\r\n    }\r\n});\r\n\r\nFramework.defineFunction({'Framework.classTwo.SubClass', {\r\n    extend: 'Framework.classTwo.Class',\r\n    \r\n    init: function(){\r\n        // init\r\n    }\r\n});\r\n```\r\n\r\n### Rank results\r\n```bash\r\n[INFO] -- rank : extClass --\r\n[INFO] 2 : Framework/classTwo/Class.js\r\n[INFO] 1 : Framework/classOne/Class.js\r\n[INFO] 1 : Framework/classTwo/SubClass.js\r\n[INFO] 0 : Framework/classOne/SubClass.js\r\n```\r\n\r\n# References\r\n\r\nInspired by _Nicholas's C. Zakas_ Combiner tool\r\n- http://www.nczonline.net/blog/2009/09/22/introducing-combiner-a-javascriptcss-concatenation-tool/\r\n- https://github.com/nzakas/combiner\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}